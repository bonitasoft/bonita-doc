<h1>1.7.2.7 Custom widgets</h1>
<p>If the <a href="widgets.md">standard widgets</a> do not meet your needs, you can create a custom widget to match exactly what you want to.
After creation, a custom widget is available in the palette for designing pages, forms or fragments.</p>
<p><a href="#description">Description</a><br>
<a href="#custom-widget-properties">Custom widget properties</a><br>
<a href="#using-external-angularjs-directive-or-service-in-a-custom-widget">Using an external AngularJS directive or service in a custom widget</a><br>
<a href="#custom-widget-translation">Translation filter</a><br>
<a href="#advanced-example">Advanced Example</a></p>
<h2>Description</h2>
<p>Custom widgets are composed of:</p>
<ul>
<li>A description that briefly describes the widget</li>
<li>Properties exposed by the widget</li>
<li>A template that describe the widget HTML markup</li>
<li>A controller that describe the widget logic</li>
<li>Some assets if the widget uses external JavaScript libraries, CSS definitions, or images</li>
<li>AngularJS modules declaration if the widget uses services or directives that are not built in to the AngularJS framework</li>
</ul>
<p>Custom widget implementation is based on the AngularJS framework.
When you open the custom widget editor to create a new custom widget, a simple example is displayed to show the basic uses of these concepts.</p>
<p>For more information, see the AngularJS guide on
<a href="https://docs.angularjs.org/guide/templates">templates</a> and
<a href="https://docs.angularjs.org/guide/controller">controllers</a>.</p>
<p>For now, you cannot implement custom widget containers.</p>
<h2>Custom widget properties</h2>
<p>Properties are variables that can be set in the properties panel when adding a custom widget to a page, form, or fragment.
A property is constant, dynamic, a bidirectional bond, or an interpolation. You can chose between these treatments when you edit the <a href="widget-properties.md#value-types">widget property</a>.
Use properties when you want the person that uses your widget to customize widget appearance or behavior. In a custom widget, a property can be used either in the template or in the controller.</p>
<p>A property has a <em>name</em> which can be referenced in the controller or the template, a <em>label</em> which will be printed in the properties panel in an editor, a <em>default</em> value, and a type.
There are several property types:</p>
<ul>
<li><strong>text</strong> user specifies the property value with some text</li>
<li><strong>choice</strong> user chooses the property value from a list that you define</li>
<li><strong>html</strong> user specifies the property value with some text that can contain basic HTML tags</li>
<li><strong>integer</strong> property value is an integer</li>
<li><strong>boolean</strong> property value is a Boolean</li>
<li><strong>collection</strong> property value is an array</li>
</ul>
<p>Each of these types will allow the user of the custom widget to bind the property value to a variable.</p>
<h2>Using an external AngularJS directive or service in a custom widget</h2>
<p>Many Angular libraries are available on the Internet and can be used in a custom widget.
To do so, download the library you want to use and add it to your custom widget as a JavaScript asset.
The downloaded library will specify a module to add to your application: add this module to the custom widget definition in the <strong>Required Angular modules</strong> field.</p>
<p>Now you can use the imported library's directives in the custom widget templates and services in the controller by injecting them in function arguments (example: <code>function($scope, myImportedService)</code>).</p>
<h2>Translation filter</h2>
<p>The <a href="multi-language-pages.md">Multi-language pages</a> explains how to manage localization (l10) inside developped pages. During page loading, the l10n strings are loaded to the l10n mechanism.</p>
<p>You can use this mechanism in the Widgets to process content to translate. There are two ways to use the localization: either the <em>uiTranslate</em> angular filter or <em>ui-translate</em> directive:</p>
<ul>
<li>Use the <em>uiTranslate</em> filter in custom widgets for dynamic content to be translated</li>
<li>Use the <em>ui-translate</em> directive in custom widgets for static content to be translated</li>
</ul>
<h4>For instance, with a custom link widget :</h4>
<p>`<div>
<a title="{{ properties.title | uiTranslate }}" ui-translate>Submit</a></p>
</div>`
<p>The link text which is static is translated using the <em>ui-translate</em> directive. The link text title held inside the <em>properties.title</em> variable is translated using the <em>uiTranslate</em> filter.</p>
<h2>Advanced example</h2>
<p>This section explains how to use the <em>carousel</em> and <em>slide</em> directives from the <code>ui.bootstrap</code> library.</p>
<p>Following the <a href="https://angular-ui.github.io/bootstrap/#/getting_started"><code>ui.bootstrap</code> documentation</a>,
<a href="https://angular-ui.github.io/bootstrap/#/carousel">download <code>ui-bootstrap-tpls.min.js</code></a> and declare the module <code>ui.bootstrap</code> as a dependency of the application.
Specifically, to use these directive in a custom widget, you need to:</p>
<ol>
<li>Download <code>ui-bootstrap-tpls.min.js</code>.</li>
<li>Add it as local JavaScript asset to the custom widget.</li>
<li>Declare the <em>ui.bootstrap</em> module in the <em>Required angular modules</em> field.</li>
</ol>
<p>You can now use the <em>carousel</em> and <em>slide</em> directives in your template. Here is a simple example of the template and controller for a carousel.</p>
<p>Template :
<code>&lt;carousel&gt; &lt;slide ng-repeat=&quot;slide in slides&quot; &gt; &lt;img ng-src=&quot;{{slide.url}}&quot; style=&quot;margin:auto;&quot; alt=&quot;{{slide.alt | uiTranslate}}&quot;&gt; &lt;/slide&gt; &lt;/carousel&gt;</code></p>
<p>Controller:
<code>function ($scope) { $scope.slides = [ { url: 'http://placekitten.com/601/300', alt:'kitty looking down' }, { url: 'http://placekitten.com/602/300', alt:'kitty in hand' }, { url: 'http://placekitten.com/603/300', alt:'kitty outside' }, { url: 'http://placekitten.com/604/300', alt:'4 kitten in basket' } ]; }</code></p>
