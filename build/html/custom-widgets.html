<h1>Custom widgets</h1>
<p>If the <a href="widgets.md">standard widgets</a> do not meet your needs, you can create a custom widget to match exactly what you want to achieve.<br>
After creation, a custom widget is available in the palette to design pages, application layouts, forms or fragments.</p>
<h2>Description</h2>
<p>Custom widgets are composed of:</p>
<ul>
<li>A description that briefly describes the widget</li>
<li>Properties exposed by the widget</li>
<li>A template that describe the widget HTML markup</li>
<li>A controller that describe the widget logic</li>
<li>Some assets if the widget uses external JavaScript libraries, CSS definitions, or images</li>
<li>AngularJS modules declaration if the widget uses services or directives that are not built in to the AngularJS framework</li>
</ul>
<p>Custom widget implementation is based on the AngularJS framework.<br>
When you open the custom widget editor to create a new custom widget, a simple example is displayed to show the basic uses of these concepts.</p>
<p>For more information, see the AngularJS guide on <a href="https://docs.angularjs.org/guide/templates">templates</a> and <a href="https://docs.angularjs.org/guide/controller">controllers</a>.</p>
<p>For now, the definition of custom containers is not yet available in the product.</p>
<h2>Custom widget properties</h2>
<p>Properties are variables that can be set in the properties panel when adding a custom widget to a page, layout, form, or fragment.<br>
A property is constant, dynamic, a bidirectional bond, or an interpolation. You can chose between these treatments when you edit the <a href="widget-properties.md">widget property</a>. Use properties when you want the front-end developer using the widget to customize widget appearance or behavior. In a custom widget, a property can be used either in the template or in the controller.</p>
<p>A property has a <em>name</em> which can be referenced in the controller or the template, a <em>label</em> which will be printed in the properties panel in an editor, a <em>default</em> value, and a type. There are several property types:</p>
<ul>
<li><strong>text</strong> user specifies the property value with some text</li>
<li><strong>choice</strong> user chooses the property value from a list that you define</li>
<li><strong>html</strong> user specifies the property value with some text that can contain basic HTML tags</li>
<li><strong>integer</strong> property value is an integer</li>
<li><strong>boolean</strong> property value is a Boolean</li>
<li><strong>collection</strong> property value is an array</li>
</ul>
<p>Each of these types will allow the front-end developer to bind the property value to a variable.</p>
<h2>Using an external AngularJS directive or service in a custom widget</h2>
<p>Many Angular libraries are available on the Internet and can be used in a custom widget. To do so, download the library you want to use and add it to your custom widget as a JavaScript asset. The downloaded library will specify a module to add to your application: add this module to the custom widget definition in the <strong>Required Angular modules</strong> field. Now you can use the imported library directives in the custom widget templates and services in the controller by injecting them in function arguments (example: <code>function($scope, myImportedService)</code>).</p>
<h2>Translation filter</h2>
<p>The <a href="multi-language-pages.md">Multi-language pages</a> tutorial explains how to manage localization (l10) inside developped pages, layouts, forms or fragments. During page loading, the l10n strings are loaded to the l10n mechanism.</p>
<p>You can use this mechanism in your custom widgets to process content to translate. There are two ways to use the localization: either the <em>uiTranslate</em> angular filter or <em>ui-translate</em> directive:</p>
<ul>
<li>Use the <em>uiTranslate</em> filter in custom widgets for dynamic content to be translated</li>
<li>Use the <em>ui-translate</em> directive in custom widgets for static content to be translated</li>
</ul>
<h4>For instance, with a custom link widget :</h4>
<p>`<div>
<a title="{{ properties.title | uiTranslate }}" ui-translate>Submit</a></p>
</div>`
<p>The link text which is static is translated using the <em>ui-translate</em> directive. The link text title held inside the <em>properties.title</em> variable is translated using the <em>uiTranslate</em> filter.</p>
<h2>Advanced example</h2>
<p>This section explains how to use the <em>carousel</em> and <em>slide</em> directives from the <code>ui.bootstrap</code> library.</p>
<p>Following the <a href="https://angular-ui.github.io/bootstrap/#/getting_started"><code>ui.bootstrap</code> documentation</a>,
<a href="https://angular-ui.github.io/bootstrap/">download <code>ui-bootstrap-tpls.min.js</code></a> and declare the module <code>ui.bootstrap</code> as a dependency of the application. Specifically, to use these directive in a custom widget, you need to:</p>
<ol>
<li>Download <code>ui-bootstrap-tpls.min.js</code>.</li>
<li>Add it as local JavaScript asset to the custom widget.</li>
<li>Declare the <em>ui.bootstrap</em> module in the <em>Required angular modules</em> field.</li>
</ol>
<p>You can now use the <em>carousel</em> and <em>slide</em> directives in your template. Here is a simple example of the template and controller for a carousel.</p>
<p>Template:</p>
<pre><code class="language-html">&lt;carousel&gt;
      &lt;slide ng-repeat=&quot;slide in slides&quot; &gt;
        &lt;img ng-src=&quot;{{slide.url}}&quot; style=&quot;margin:auto;&quot; alt=&quot;{{slide.alt | uiTranslate}}&quot;&gt;
      &lt;/slide&gt;
    &lt;/carousel&gt;
</code></pre>
<p>Controller:</p>
<pre><code class="language-javascript">function ($scope) {
      $scope.slides = [
        { url: 'http://placekitten.com/601/300', alt:'kitty looking down' },
        { url: 'http://placekitten.com/602/300', alt:'kitty in hand' },
        { url: 'http://placekitten.com/603/300', alt:'kitty outside' },
        { url: 'http://placekitten.com/604/300', alt:'4 kitten in basket' }
       ];
    }
</code></pre>
