<h1>Connector development toolkit</h1>
<h2>Overview</h2>
<p>The Connector Development Toolkit is a set of tools for implementing and testing Bonita BPM connectors independently of the Bonita BPM Studio.<br>
A connector implemented with the toolkit can be used in Bonita BPM Studio or in Bonita BPM Portal just like any Bonita BPM connector.</p>
<p>This toolkit uses industry-standard tools such as Java IDEs, dependency management tools (Maven), and unit testing frameworks (JUnit, Mockito and AssertJ).
It has the following benefits for connector developers:</p>
<ul>
<li>You can use any Java IDE for implementation, so you have access to all configuration options and can make use of convenient features such as refactoring.</li>
<li>You can unit test connectors, perform integration tests, and automate builds with a CI platforms.</li>
<li>It simplifies refactoring of connector wizards, by enabling them to be regenerated them at any time.</li>
<li>It simplifies dependency management and connector artifact version management, by leveraging Maven capabilities.</li>
</ul>
<h2>Installation</h2>
<h3>Prerequisites</h3>
<p>To develop and test a Bonita BPM connector with the toolkit, you need the following software installed:</p>
<ul>
<li>Java 7 or later</li>
<li>Maven 3.2.x or later</li>
</ul>
<h3>Installation procedure</h3>
<ol>
<li>Download the toolkit from the Customer Portal.</li>
<li>Unzip the toolkit file into a temporary installation folder.</li>
<li>Run either <code>install.bat</code> for Windows users or <code>install.sh</code> for Mac or Linux users.</li>
<li>When the installer has finished, delete the temporary installation folder because you no longer not need.</li>
</ol>
<h2>Creating a new connector definition</h2>
<ol>
<li>Open a command window and navigate to the folder that will hold your connector definition.</li>
<li>Prepare to run the following command (Windows users: remove the trailing slashes and edit the content to have everything on a single line):</li>
</ol>
<pre><code class="language-bash">mvn archetype:generate \
    -DinteractiveMode=false \
    -DarchetypeGroupId=com.bonitasoft.connector.definition \
    -DarchetypeArtifactId=bonita-connector-definition-archetype \
    -DarchetypeVersion=1.0 \
    -DgroupId=com.mycompany.connectors \
    -DartifactId=myFirstConnector \
    -Dversion=1.0.0
</code></pre>
<p>Before running the command, update the following parameter values:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Parameter</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">archetypeVersion</td>
<td style="text-align:left">This must match the version of the toolkit.</td>
</tr>
<tr>
<td style="text-align:left">groupId</td>
<td style="text-align:left">Maven project group id.</td>
</tr>
<tr>
<td style="text-align:left">artifactId</td>
<td style="text-align:left">Maven project artifact id and Bonita BPM connector definition id.</td>
</tr>
<tr>
<td style="text-align:left">version</td>
<td style="text-align:left">Maven project version and Bonita BPM connector definition version.</td>
</tr>
</tbody>
</table>
<ol start="3">
<li>Run the command. This generates a new folder named <code>artifactId</code> containing the connector definition project files, as follows:</li>
</ol>
<pre><code>&lt;artifactId&gt;/
    src/main/resources/
        category-icon.png
        connector_definition.xml
        connector-icon.png
    pom.xml
</code></pre>
<ol start="4">
<li>Configure the <code>src/main/resources/connector_definition.xml</code> file to define the connector wizard pages with their inputs, widgets,and outputs (see <a href="#widgetTypeReference">Connector widget reference</a> for details).</li>
<li>Optionally, change the icons for the connector and the connector category in the <code>src/main/resources</code> folder.</li>
</ol>
<h2>Creating a new connector implementation</h2>
<p>A connector definition can hold multiple implementations so the steps described in this section can be repeated.<br>
All implementations will be stored under the definition project folder.</p>
<p><strong>Caution:</strong> Connector implementations that are not located under the definition project folder will not compile.</p>
<ol>
<li>Open a command window and navigate to the folder that contains the connector definition project.</li>
<li>Prepare to run the following command (Windows users: remove the trailing slashes and edit the content to have everything on a single line):</li>
</ol>
<pre><code class="language-bash">mvn archetype:generate \
    -DinteractiveMode=false \
    -DarchetypeGroupId=com.bonitasoft.connector.implementation \
    -DarchetypeArtifactId=bonita-connector-implementation-archetype \
    -DarchetypeVersion=1.0 \
    -DgroupId=com.mycompany.connectors \
    -DartifactId=myFirstConnectorImpl \
    -Dversion=1.0.0 \
    -DdefinitionId=myFirstConnector \
    -DdefinitionVersion=1.0.0
</code></pre>
<p>Before running the command, update the following parameter values:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>archetypeVersion</td>
<td>This should match the version of the toolkit</td>
</tr>
<tr>
<td>groupId</td>
<td>Maven project group id and Java package for the Bonita BPM connector implementation</td>
</tr>
<tr>
<td>artifactId</td>
<td>Maven artifact id and Bonita BPM connector implementation id</td>
</tr>
<tr>
<td>version</td>
<td>Maven version id and Bonita BPM connector implementation version</td>
</tr>
<tr>
<td>definitionId</td>
<td>This should match the connector definition artifactId</td>
</tr>
<tr>
<td>definitionVersion</td>
<td>This should match the connector definition version</td>
</tr>
</tbody>
</table>
<ol start="3">
<li>Run the command. This generates a new folder named <code>artifactId</code> containing the connector implementation project.</li>
<li>In the connector implementation project folder, run the following command :</li>
</ol>
<pre><code class="language-bash">mvn bonita-connector-definition:generate
</code></pre>
<p>This generates the connector abstract definition class based on the definition configuration: <code>&lt;artifactId&gt;/src/main/java/&lt;groupId&gt;/Abstract&lt;ConnectorDefinitionArtifactId&gt;.java</code></p>
<p><strong>Note:</strong>
If you subsequently change the connector definition configuration, run this command again to apply your changes.<br>
This will regenerate the abstract definition class, overwriting the previous version.</p>
<ol start="5">
<li>In the connector implementation project folder, run the following command : <code>mvn bonita-connector-implementation:generate</code></li>
</ol>
<p>This generates a stub of the connector implementation and test classes:</p>
<pre><code>src/main/java/&lt;groupId&gt;/&lt;artifactId&gt;.java
src/test/java/&lt;groupId&gt;/&lt;artifactId&gt;Tests.java
</code></pre>
<p><em>Caution:</em>* Do not run this command again at a later stage, because it resets your implementation and test classes.</p>
<ol start="6">
<li>Complete your connector implementation and test classes.</li>
<li>When you are ready to package the connector, run this command in the implementation project folder: <code>mvn package</code></li>
</ol>
<p>This will produce a connector zip file that can be imported in Bonita BPM Studio: <code>/target/&lt;artifactId&gt;-&lt;version&gt;-dist.zip</code></p>
<a id="widgetTypeReference"/>
<h2>Widget types and parameters</h2>
<p>The following widget types are supported in connectors:</p>
<table>
<thead>
<tr>
<th>Widget</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Text</td>
<td>Text field</td>
</tr>
<tr>
<td>Password</td>
<td>Text field with obfuscated characters</td>
</tr>
<tr>
<td>TextArea</td>
<td>Multi-line text field</td>
</tr>
<tr>
<td>Checkbox</td>
<td>Single checkbox</td>
</tr>
<tr>
<td>RadioGroup</td>
<td>Group of radio buttons</td>
</tr>
<tr>
<td>Select</td>
<td>Drop down</td>
</tr>
<tr>
<td>Array</td>
<td>Editable table with user customizable rows and columns</td>
</tr>
<tr>
<td>ScriptEditor</td>
<td>Multi-line text zone for entering a script</td>
</tr>
<tr>
<td>List</td>
<td>List in which user can add/remove elements</td>
</tr>
<tr>
<td>Group</td>
<td>Collapsile zone that contains one or more widgets</td>
</tr>
</tbody>
</table>
<p>This is the same as the set of connector widgets available in Bonita BPM Studio.</p>
<p>A widget is configured by setting parameters. Some <a href="#mandatory-common">mandatory parameters</a> and <a href="#optional-common">optional parameters</a> are common to all types of widget.
There are also some specific widget properties for some types of widget, which are listed later in this page.</p>
<a id="mandatory-common"/>
<h3>Mandatory common widget parameters</h3>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>Unique widget identifier.</td>
</tr>
<tr>
<td>label</td>
<td>Text displayed beside the widget.</td>
</tr>
<tr>
<td>widgetType</td>
<td>Type of the widget. Set this to Text, Password, TextArea, Checkbox, RadioGroup, Select, Array, ScriptEditor, List, or Group.</td>
</tr>
<tr>
<td>javaType</td>
<td>Java type used to assign the value of this widget. This is not supported for Group widgets.</td>
</tr>
</tbody>
</table>
<a id="optional-common"/>
<h3>Optional common widget parameters</h3>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td>mandatory</td>
<td>Boolean flag that indicates whether or not this widget can be left empty.</td>
<td>true</td>
</tr>
<tr>
<td>defaultValue</td>
<td>Default value assigned to this widget.</td>
<td>n/a</td>
</tr>
<tr>
<td>description</td>
<td>Mouseover text displayed by the 'information' icon beside the widget. If there is no description, the icon is not displayed.</td>
<td>n/a</td>
</tr>
</tbody>
</table>
<p>The following example is the configuration for a Text widget:</p>
<pre><code class="language-xml">&lt;widget&gt;
    &lt;id&gt;firstName&lt;/id&gt;
    &lt;label&gt;First name&lt;/label&gt;
    &lt;widgetType&gt;Text&lt;/widgetType&gt;
    &lt;javaType&gt;java.lang.String&lt;/javaType&gt;
    &lt;mandatory&gt;true&lt;/mandatory&gt;
    &lt;defaultValue&gt;John&lt;/defaultValue&gt;
    &lt;description&gt;Your first name&lt;/description&gt;
&lt;/widget&gt;
</code></pre>
<h3>RadioGroup widget parameters</h3>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Mandatory</th>
<th>Description</th>
<th>Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td>choices</td>
<td>yes</td>
<td>List of values for the radio button group. Each value is specified in a &quot;choice&quot; tag.</td>
<td>n/a</td>
</tr>
<tr>
<td>orientation</td>
<td>no</td>
<td>Alignment of the widget values. One of: HORIZONTAL or VERTICAL.</td>
<td>VERTICAL</td>
</tr>
</tbody>
</table>
<p>The following example is the configuration for a RadioGroup widget with three choices:</p>
<pre><code class="language-xml">&lt;widget&gt;
        &lt;id&gt;radioGroup&lt;/id&gt;
        &lt;label&gt;RadioGroup widget&lt;/label&gt;
        &lt;javaType&gt;java.lang.String&lt;/javaType&gt;
        &lt;widgetType&gt;RadioGroup&lt;/widgetType&gt;
        &lt;choices&gt;
                &lt;choice&gt;Choice1&lt;/choice&gt;
                &lt;choice&gt;Choice2&lt;/choice&gt;
                &lt;choice&gt;Choice3&lt;/choice&gt;
        &lt;/choices&gt;
        &lt;orientation&gt;VERTICAL&lt;/orientation&gt;
&lt;/widget&gt;
</code></pre>
<h3>Select widget parameters</h3>
<table>
<thead>
<tr>
<th style="text-align:left">Parameter</th>
<th style="text-align:left">Mandatory</th>
<th style="text-align:left">Description</th>
<th style="text-align:left">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">items</td>
<td style="text-align:left">yes</td>
<td style="text-align:left">List of values for the widget. Each value is specified in an &quot;item&quot; tag.</td>
<td style="text-align:left">n/a</td>
</tr>
</tbody>
</table>
<p>The following example is the configuration for a Select widget with three choices:</p>
<pre><code class="language-xml">&lt;widget&gt;
        &lt;id&gt;select&lt;/id&gt;
        &lt;label&gt;Select widget&lt;/label&gt;
        &lt;javaType&gt;java.lang.String&lt;/javaType&gt;
        &lt;widgetType&gt;Select&lt;/widgetType&gt;
        &lt;items&gt;
                &lt;item&gt;Item1&lt;/item&gt;
                &lt;item&gt;Item2&lt;/item&gt;
                &lt;item&gt;Item3&lt;/item&gt;
        &lt;/items&gt;
&lt;/widget&gt;
</code></pre>
<h3>Array widget specific parameters</h3>
<p>All Array widget specific parameters are mandatory and must be placed under a single parent &quot;arrayOptions&quot; tag.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>cols</td>
<td>Initial number of columns in the table.</td>
</tr>
<tr>
<td>rows</td>
<td>Initial number of rows in the table. A value of -1 indicates a table with no row (only the column headers are displayed).</td>
</tr>
<tr>
<td>fixedCols</td>
<td>Boolean flag that indicates whether the number of table columns can be modified by the end user. If set to &quot;true&quot;, the user cannot add or remove columns.</td>
</tr>
<tr>
<td>fixedRows</td>
<td>Boolean flag that indicates whether the number of table rows can be modified by the end user. If set to &quot;true&quot;, the user cannot add or remove rows.</td>
</tr>
<tr>
<td>colsCaption</td>
<td>List of captions for the column headers. Each caption is specified in a &quot;colsCaption&quot; tag.</td>
</tr>
</tbody>
</table>
<p>The following example is the configuration for an Array widget two columns and any number of rows:</p>
<pre><code class="language-xml">&lt;widget&gt;
        &lt;id&gt;array&lt;/id&gt;
        &lt;label&gt;Array widget&lt;/label&gt;
        &lt;javaType&gt;java.util.List&lt;/javaType&gt;
        &lt;widgetType&gt;Array&lt;/widgetType&gt;
        &lt;arrayOptions&gt;
                &lt;cols&gt;2&lt;/cols&gt;
                &lt;rows&gt;-1&lt;/rows&gt;
                &lt;fixedCols&gt;true&lt;/fixedCols&gt;
                &lt;fixedRows&gt;false&lt;/fixedRows&gt;
                &lt;colsCaptions&gt;
                        &lt;colsCaption&gt;Header 1&lt;/colsCaption&gt;
                        &lt;colsCaption&gt;Header 2&lt;/colsCaption&gt;
                &lt;/colsCaptions&gt;
        &lt;/arrayOptions&gt;
&lt;/widget&gt;
</code></pre>
<h3>List widget specific parameters</h3>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Mandatory</th>
<th>Description</th>
<th>Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td>showDocuments</td>
<td>no</td>
<td>Boolean flag that indicates whether the end user can select Bonita BPM documents in the list of values.</td>
<td>false</td>
</tr>
</tbody>
</table>
<p>The following example is the configuration for a List widget:</p>
<pre><code>&lt;widget&gt;
        &lt;id&gt;list&lt;/id&gt;
        &lt;label&gt;List widget&lt;/label&gt;
        &lt;javaType&gt;java.util.List&lt;/javaType&gt;
        &lt;widgetType&gt;List&lt;/widgetType&gt;
        &lt;showDocuments&gt;true&lt;/showDocuments&gt;
&lt;/widget&gt;
</code></pre>
<h3>Group widget parameters</h3>
<p><strong>Note:</strong> A Group widget does not support the common &quot;javaType&quot; parameter.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>collapsed</td>
<td>Boolean flag that indicates whether the group is collapsed by default.</td>
</tr>
<tr>
<td>widgets</td>
<td>Specifies the list of widgets contained in the group.</td>
</tr>
</tbody>
</table>
<p>The following example is the configuration for a Group widget that contains two other widgets:</p>
<pre><code class="language-xml">&lt;widget&gt;
        &lt;id&gt;credentials&lt;/id&gt;
        &lt;widgetType&gt;Group&lt;/widgetType&gt;
        &lt;label&gt;User credentials&lt;/label&gt;
        &lt;collapsed&gt;true&lt;/collapsed&gt;
        &lt;widgets&gt;
                &lt;widget&gt;
                        &lt;id&gt;login&lt;/id&gt;
                        &lt;javaType&gt;java.lang.String&lt;/javaType&gt;
                        &lt;mandatory&gt;true&lt;/mandatory&gt;
                        &lt;widgetType&gt;Text&lt;/widgetType&gt;
                        &lt;label&gt;Login&lt;/label&gt;
                &lt;/widget&gt;
                &lt;widget&gt;
                        &lt;id&gt;password&lt;/id&gt;
                        &lt;javaType&gt;java.lang.String&lt;/javaType&gt;
                        &lt;mandatory&gt;true&lt;/mandatory&gt;
                        &lt;widgetType&gt;Password&lt;/widgetType&gt;
                        &lt;label&gt;Password&lt;/label&gt;
                &lt;/widget&gt;
        &lt;/widgets&gt;
&lt;/widget&gt;
</code></pre>
