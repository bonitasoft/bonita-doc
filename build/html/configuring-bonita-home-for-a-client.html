<h1>Configuring Bonita Home for a client</h1>
<p>##Deprecated, use the programmatic way instead, see <a href="http://documentation.bonitasoft.com/javadoc/api/7.2/org/bonitasoft/engine/util/APITypeManager.html">APITypeManager</a>.</p>
<p>This page explains how to set up a <a href="bonita-home.md">Bonita home</a> folder to configure properties for a client application. Every client application needs its own Bonita home.</p>
<p>The <code>bonita.home</code> system property points to the root directory for a client application of Bonita BPM.
The directory contains a <code>client</code> subdirectory, which contains a <code>conf</code> subdirectory.
The <code>conf</code> subdirectory contains the <code>bonita-client.properties</code> file. This properties file
defines how the client application connects to the Bonita BPM Engine.</p>
<p>There can be multiple clients accessing the same Bonita BPM Engine. Each client application runs in its own JVM and needs its own <code>bonita.home</code> system property, directory tree,
and <code>bonita-client.properties</code> file. If you modify the <code>bonita-client.properties</code> files inside the application server or in the <code>bonita.home</code> of another application
such as the Bonita BPM Portal, you risk breaking existing applications.</p>
<p>The following is an example of <code>${bonita.home}/client/conf/bonita-client.properties</code> for an application
called myClientAppExample that is using a Bonita BPM Engine that is running with Tomcat:</p>
<pre><code class="language-properties">application.name=myClientAppExample
org.bonitasoft.engine.api-type=HTTP
server.url=http://localhost:8080
</code></pre>
<p>The properties set in this example are the name of the application (<code>myClientAppExample</code>), the URL of the server including
the port number (<code>http://localhost:8080</code>), and the type of server access (<code>HTTP</code>).</p>
<p>The Bonita BPM bundles are delivered with a <code>bonita-client.properties</code> file configured for use by a Bonita BPM Portal
that is accessing the server locally. This file also contains template definitions for other access modes. You can take a
copy of this file and use it as a template. The properties required vary depending on the access type that is used.</p>
<pre><code class="language-properties">###template file
# LOCAL
org.bonitasoft.engine.api-type = LOCAL

# HTTP
#org.bonitasoft.engine.api-type = HTTP
#server.url = http://localhost:8080
#application.name = bonita

# Remote: EJB3
#org.bonitasoft.engine.api-type = EJB3
# JBoss AS 7
#java.naming.factory.url.pkgs = org.jboss.ejb.client.naming
#default EJB reference name
#org.bonitasoft.engine.ejb.naming.reference=ejb:bonita-ear/bonita-ejb/serverAPIBean!org.bonitasoft.engine.api.internal.ServerAPI
# JBoss 5
#java.naming.factory.initial = org.jnp.interfaces.NamingContextFactory
#java.naming.provider.url = jnp://localhost:1099
#org.bonitasoft.engine.ejb.naming.reference=serverAPI
</code></pre>
<p>The client applicaton classpath must include any jar files referenced in the <code>bonita-client.properties</code> file.</p>
<h2>EJB3 connection and JBoss 7</h2>
<p>For an EJB3 connection to work with JBoss 7, there are some additional configuration steps.</p>
<p>In the JBoss administration console, <a href="https://docs.jboss.org/author/display/AS71/Admin+Guide#AdminGuide-adduser.sh">create a user account</a> to be used for remote connections.</p>
<p><strong>Add a properties file</strong>, <code>jboss-ejb-client.properties</code>, to the client classpath. This file is in the <code>$JBOSS_HOME/bin/client</code> folder.
It contains information needed to make the remote connection, including the username and password of the user you created in the JBoss console, as shown below:</p>
<pre><code class="language-properties">endpoint.name=client-endpoint
remote.connectionprovider.create.options.org.xnio.Options.SSL_ENABLED=false
remote.connections=default
 
remote.connection.default.host=myhostname
remote.connection.default.port = 4447
remote.connection.default.connect.options.org.xnio.Options.SASL_POLICY_NOANONYMOUS=false
remote.connection.default.username 
remote.connection.default.password 
</code></pre>
<p>Add the following <strong>Maven dependency</strong>:</p>
<pre><code>&lt;dependency&gt;
        &lt;groupId&gt;org.jboss.as&lt;/groupId&gt;
        &lt;artifactId&gt;jboss-as-ejb-client-bom&lt;/artifactId&gt;
        &lt;version&gt;7.1.1.Final&lt;/version&gt;
        &lt;type&gt;pom&lt;/type&gt;
&lt;/dependency&gt;  
</code></pre>
<p><strong>Update the JBoss configuration file</strong>, <code>standalone.xml</code>:</p>
<ul>
<li>In the <code>interfaces</code> section, modify the IP address so that the Bonita BPM Engine is visible to the network.</li>
<li>Specify that port 4447 comes from the remoting socket-binding.</li>
</ul>
